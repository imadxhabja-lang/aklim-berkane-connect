<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>دليل أكليم وبركان | خدمات محلية وأرقام هواتف</title>
    <meta name="description" content="دليل الخدمات المحلية وأرقام الهواتف في مدينة أكليم وبركان. ابحث عن أي خدمة محلية وتواصل مباشرة.">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ... (كل الأنماط السابقة تبقى كما هي) ... */
    </style>
</head>
<body>
    <!-- ... (بقية الهيكل كما هو) ... -->
    
    <div class="container">
        <!-- تبويب إضافة خدمة -->
        <div id="add-service-tab" class="tab-content">
            <div class="form-container">
                <h2 style="margin-bottom: 20px; text-align: center; color: var(--primary-color);">
                    <i class="fas fa-plus-circle"></i> أضف خدمتك الآن
                </h2>
                
                <!-- إعلان في نموذج الإضافة -->
                <div class="ad-banner" style="margin-bottom: 20px; background: linear-gradient(135deg, #4CAF50, #8BC34A);">
                    <h4><i class="fas fa-gift"></i> إضافة مجانية!</h4>
                    <p>لا توجد رسوم لإضافة خدمتك الأولى</p>
                </div>
                
                <form id="service-form">
                    <!-- ✅ هنا تم تصحيح خانة نوع الخدمة ✅ -->
                    <div class="form-group">
                        <label class="form-label">نوع الخدمة *</label>
                        <select class="form-select" id="serviceType" required onchange="toggleServiceFields()">
                            <option value="">اختر نوع الخدمة</option>
                            <option value="كهربائي">كهربائي</option>
                            <option value="سباك">سباك</option>
                            <option value="نجار">نجار</option>
                            <option value="طبيب">طبيب</option>
                            <option value="صيدلية">صيدلية</option>
                            <option value="كراء السيارات">كراء السيارات</option>
                            <option value="توصيل">خدمة توصيل</option> <!-- ✅ تمت الإضافة هنا ✅ -->
                            <option value="ميكانيكي">ميكانيكي</option>
                            <option value="مطعم">مطعم</option>
                            <option value="مقهى">مقهى</option>
                            <option value="بقالة">بقالة</option>
                            <option value="حداد">حداد</option>
                            <option value="محامي">محامي</option>
                            <option value="محاسب">محاسب</option>
                            <option value="مدرس">مدرس</option>
                            <option value="حلاق">حلاق</option>
                            <option value="خياط">خياط</option>
                            <option value="نجار">نجار</option>
                            <option value="أخرى">أخرى</option>
                        </select>
                    </div>
                    
                    <!-- باقي النموذج يبقى كما هو -->
                    <div class="form-group">
                        <label class="form-label">اسم الخدمة *</label>
                        <input type="text" class="form-input" id="serviceName" placeholder="مثال: خدمة توصيل طعام، كراء سيارة دفع رباعي" required>
                    </div>
                    
                    <!-- حقول خاصة بكراء السيارات -->
                    <div id="car-fields" style="display: none;">
                        <div class="form-group">
                            <label class="form-label">نوع السيارة</label>
                            <select class="form-select" id="carType">
                                <option value="">اختر نوع السيارة</option>
                                <option value="سيارة عائلية">سيارة عائلية</option>
                                <option value="سيارة دفع رباعي">سيارة دفع رباعي</option>
                                <option value="سيارة صغيرة">سيارة صغيرة</option>
                                <option value="فان">فان</option>
                                <option value="شاحنة">شاحنة</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">سعر الكراء (يومياً)</label>
                            <input type="text" class="form-input" id="carPrice" placeholder="مثال: 200 درهم">
                        </div>
                    </div>
                    
                    <!-- ✅ حقول خاصة بخدمات التوصيل ✅ -->
                    <div id="delivery-fields" style="display: none;">
                        <div class="form-group">
                            <label class="form-label">نوع التوصيل *</label>
                            <select class="form-select" id="deliveryServiceType" required>
                                <option value="">اختر نوع التوصيل</option>
                                <option value="طعام">توصيل طعام</option>
                                <option value="مستندات">توصيل مستندات</option>
                                <option value="منتجات">توصيل منتجات</option>
                                <option value="طرود">توصيل طرود</option>
                                <option value="أخرى">خدمات توصيل أخرى</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">سعر التوصيل (بداية السعر)</label>
                            <input type="text" class="form-input" id="deliveryPrice" placeholder="مثال: 20 درهم">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">المدن التي تخدمها</label>
                            <div style="display: flex; gap: 15px; margin-top: 10px; flex-wrap: wrap;">
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="checkbox" id="city-aklim" value="أكليم">
                                    أكليم
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="checkbox" id="city-berkan" value="بركان">
                                    بركان
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="checkbox" id="city-both" value="كلا المدينتين">
                                    كلا المدينتين
                                </label>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">وقت الاستجابة التقريبي</label>
                            <input type="text" class="form-input" id="deliveryTime" placeholder="مثال: 30 دقيقة">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">نوع وسيلة النقل</label>
                            <select class="form-select" id="deliveryVehicle">
                                <option value="">اختر وسيلة النقل</option>
                                <option value="دراجة نارية">دراجة نارية</option>
                                <option value="سيارة صغيرة">سيارة صغيرة</option>
                                <option value="فان">فان</option>
                                <option value="شاحنة صغيرة">شاحنة صغيرة</option>
                                <option value="أخرى">أخرى</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- باقي النموذج -->
                    <div class="form-group">
                        <label class="form-label">اسمك *</label>
                        <input type="text" class="form-input" id="providerName" placeholder="أدخل اسمك" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">رقم الهاتف *</label>
                        <input type="tel" class="form-input" id="servicePhone" placeholder="مثال: 0612345678" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">المدينة *</label>
                        <select class="form-select" id="serviceCity" required>
                            <option value="">اختر المدينة</option>
                            <option value="أكليم">أكليم</option>
                            <option value="بركان">بركان</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">وصف الخدمة</label>
                        <textarea class="form-textarea" id="serviceDesc" placeholder="صف خدمتك... مثال: خدمة توصيل سريعة، نعمل 24/7، أسعار تنافسية"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">ساعات العمل</label>
                        <input type="text" class="form-input" id="workingHours" placeholder="مثال: 8:00 - 22:00">
                    </div>
                    
                    <button type="submit" class="submit-btn">
                        <i class="fas fa-check"></i> إضافة الخدمة
                    </button>
                </form>
                
                <div id="success-message" style="display: none; text-align: center; padding: 20px; background: #f0f9ff; border-radius: var(--radius); margin-top: 20px;">
                    <i class="fas fa-check-circle" style="color: #4CAF50; font-size: 3rem; margin-bottom: 10px;"></i>
                    <h3 style="color: #4CAF50;">تمت الإضافة بنجاح!</h3>
                    <p style="margin: 10px 0;">سيتم عرض خدمتك في الدليل</p>
                    <div style="display: flex; gap: 10px; justify-content: center; margin-top: 15px;">
                        <button onclick="showTab('home')" style="background: var(--primary-color); color: white; border: none; padding: 10px 20px; border-radius: var(--radius); cursor: pointer;">
                            العودة للرئيسية
                        </button>
                        <button onclick="addAnotherService()" style="background: #4CAF50; color: white; border: none; padding: 10px 20px; border-radius: var(--radius); cursor: pointer;">
                            إضافة أخرى
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ... باقي المحتوى ... -->
    </div>

    <script>
        // ✅ تحديث دالة toggleServiceFields لتعامل مع حقول التوصيل
        function toggleServiceFields() {
            const type = document.getElementById('serviceType').value;
            const carFields = document.getElementById('car-fields');
            const deliveryFields = document.getElementById('delivery-fields');
            
            carFields.style.display = 'none';
            deliveryFields.style.display = 'none';
            
            if (type === 'كراء السيارات') {
                carFields.style.display = 'block';
            } else if (type === 'توصيل') {
                deliveryFields.style.display = 'block';
            }
        }

        // ✅ تحديث دالة إضافة الخدمة لتتعامل مع حقول التوصيل
        document.getElementById('service-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const serviceType = document.getElementById('serviceType').value;
            const isCarRental = serviceType === 'كراء السيارات';
            const isDelivery = serviceType === 'توصيل'; // ✅ التحقق من نوع التوصيل
            
            const newService = {
                id: Date.now(),
                name: document.getElementById('serviceName').value,
                phone: document.getElementById('servicePhone').value,
                city: document.getElementById('serviceCity').value,
                type: serviceType,
                provider: document.getElementById('providerName').value,
                addedDate: new Date().toLocaleDateString('ar-EG'),
                workingHours: document.getElementById('workingHours').value || 'غير محدد',
                featured: Math.random() > 0.7,
                rating: 0,
                views: 0,
                calls: 0
            };
            
            // ✅ إضافة حقول كراء السيارات
            if (isCarRental) {
                newService.carType = document.getElementById('carType').value;
                newService.price = document.getElementById('carPrice').value;
                newService.category = 'كراء السيارات';
            }
            
            // ✅ إضافة حقول التوصيل
            if (isDelivery) {
                newService.deliveryType = document.getElementById('deliveryServiceType').value;
                newService.deliveryPrice = document.getElementById('deliveryPrice').value || 'اتصل للاستفسار';
                newService.deliveryTime = document.getElementById('deliveryTime').value || 'سريع';
                newService.deliveryVehicle = document.getElementById('deliveryVehicle').value;
                newService.category = 'توصيل';
                
                // ✅ معالجة المدن التي يخدمها
                const cities = [];
                if (document.getElementById('city-aklim').checked) cities.push('أكليم');
                if (document.getElementById('city-berkan').checked) cities.push('بركان');
                if (document.getElementById('city-both').checked) cities.push('كلا المدينتين');
                newService.servesCities = cities.length > 0 ? cities.join('، ') : newService.city;
            }
            
            // ✅ إضافة وصف الخدمة
            if (document.getElementById('serviceDesc').value) {
                newService.description = document.getElementById('serviceDesc').value;
            }
            
            // ✅ إضافة للخدمات
            services.unshift(newService);
            
            // ✅ حفظ في localStorage
            let userServices = JSON.parse(localStorage.getItem('userServices')) || [];
            userServices.push(newService);
            localStorage.setItem('userServices', JSON.stringify(userServices));
            
            // ✅ تحديث الواجهة
            document.getElementById('service-form').reset();
            document.getElementById('success-message').style.display = 'block';
            document.getElementById('car-fields').style.display = 'none';
            document.getElementById('delivery-fields').style.display = 'none';
            
            showNotification('تمت إضافة خدمتك بنجاح!');
            
            // ✅ تحديث العروض
            setTimeout(() => {
                updateStats();
                displayFeaturedServices();
                displayAllServices();
                displayCarRentalServices();
                displayDeliveryServices();
            }, 500);
        });

        // ✅ عند تحميل الصفحة، تأكد من تحميل خدمات التوصيل
        document.addEventListener('DOMContentLoaded', function() {
            const savedServices = localStorage.getItem('userServices');
            if (savedServices) {
                const userServices = JSON.parse(savedServices);
                services = [...services, ...userServices];
            }
            
            updateStats();
            displayFeaturedServices();
            displayAllServices();
            displayCarRentalServices();
            displayDeliveryServices(); // ✅ تحميل خدمات التوصيل
            loadAds();
        });

        // ✅ إضافة نوع التوصيل إلى قائمة التصفية
        function filterServices(category) {
            const container = document.getElementById('all-services');
            container.innerHTML = '';
            
            let filtered = services;
            if (category === 'أكليم' || category === 'بركان') {
                filtered = services.filter(s => s.city === category);
            } else if (category === 'كراء السيارات') {
                filtered = services.filter(s => s.type === category);
            } else if (category === 'توصيل') { // ✅ إضافة التوصيل للتصفية
                filtered = services.filter(s => s.type === category);
            }
            
            // ... باقي الكود
        }

        // ✅ إضافة تصفية خدمات التوصيل
        function filterDeliveryServices() {
            const city = document.getElementById('delivery-city-filter').value;
            const serviceType = document.getElementById('delivery-service-filter').value;
            
            const container = document.getElementById('delivery-services-list');
            container.innerHTML = '';
            
            let filtered = services.filter(s => s.type === 'توصيل');
            
            if (city) {
                filtered = filtered.filter(s => s.city === city || 
                    (s.servesCities && s.servesCities.includes(city)));
            }
            
            if (serviceType) {
                filtered = filtered.filter(s => s.deliveryType === serviceType);
            }
            
            // ... باقي الكود
        }

        // ✅ إضافة دالة عرض خدمات التوصيل
        function displayDeliveryServices() {
            const container = document.getElementById('delivery-services-list');
            const featuredContainer = document.getElementById('featured-delivery');
            
            const deliveryServices = services.filter(s => s.type === 'توصيل');
            
            // ... باقي الكود
        }
    </script>
</body>
                        </html>
