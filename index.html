<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Berkane Connect | Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø³ØªÙ‚Ø±Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800;900&display=swap');
        
        body { font-family: 'Tajawal', sans-serif; background-color: #f8fafc; direction: rtl; }

        /* Ø´Ø±ÙŠØ· Ø§Ù„Ø£Ø®Ø¨Ø§Ø± Ø§Ù„Ø¹Ù„ÙˆÙŠ */
        .news-marquee { background: #0f172a; color: #f59e0b; padding: 12px 0; font-weight: 800; overflow: hidden; white-space: nowrap; border-bottom: 3px solid #f59e0b; }
        .news-content { display: inline-block; animation: scroll-news 25s linear infinite; }

        /* Ø´Ø±ÙŠØ· Ø§Ù„Ø¥Ù‡Ø¯Ø§Ø¡Ø§Øª */
        .gift-marquee { background: #1e40af; color: white; padding: 8px 0; font-size: 0.85rem; overflow: hidden; white-space: nowrap; }
        .gift-content { display: inline-block; animation: scroll-gift 30s linear infinite; }

        @keyframes scroll-news { 0% { transform: translateX(-100%); } 100% { transform: translateX(100%); } }
        @keyframes scroll-gift { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }

        /* Ø£Ù„ÙˆØ§Ù† Ø§Ù„ÙƒØ±ÙˆØª Ø­Ø³Ø¨ Ø§Ù„ØµÙ†Ù */
        .service-card { background: white; border-radius: 1.5rem; padding: 1.5rem; transition: 0.3s; border-bottom: 6px solid #e2e8f0; }
        .card-woman { border-bottom-color: #ec4899 !important; background: #fff5f7; } /* Ø³ÙŠØ¯ØªÙŠ ÙˆØ±Ø¯ÙŠ */
        .card-tech { border-bottom-color: #1e40af !important; } /* Ø®Ø¯Ù…Ø§Øª Ø£Ø²Ø±Ù‚ */
        .card-food { border-bottom-color: #10b981 !important; } /* Ù…Ø·Ø¨Ø® Ø£Ø®Ø¶Ø± */
        .card-pharmacy { border-bottom-color: #ef4444 !important; } /* ØµÙŠØ¯Ù„ÙŠØ© Ø£Ø­Ù…Ø± */

        .hidden { display: none !important; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body>

    <div class="news-marquee">
        <div class="news-content" id="news-ticker">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨ÙƒÙ… ÙÙŠ Ø¨Ø±ÙƒØ§Ù† ÙƒÙˆÙ†ÙŠÙƒØª .. Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø®Ø¨Ø§Ø± ..</div>
    </div>

    <div class="gift-marquee">
        <div class="gift-content" id="gift-ticker">Ø£Ø±Ø³Ù„ÙˆØ§ Ø¥Ù‡Ø¯Ø§Ø¡Ø§ØªÙƒÙ… Ø§Ù„Ø¢Ù† Ù„ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ .. Ù…Ù†ØµØ© Ù…Ø¯ÙŠÙ†Ø© Ø¨Ø±ÙƒØ§Ù† ÙˆØ£ÙƒÙ„ÙŠÙ… ØªØ±Ø­Ø¨ Ø¨ÙƒÙ… ..</div>
    </div>

    <nav class="bg-white p-4 shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <div class="text-2xl font-black italic text-slate-900">BERKANE<span class="text-blue-600">.</span>CONNECT</div>
            <div class="flex gap-3">
                <button onclick="toggleModal('reg-modal', true)" class="bg-blue-600 text-white px-5 py-2 rounded-xl font-bold shadow-lg">+ Ø£Ø¶Ù Ø®Ø¯Ù…ØªÙƒ</button>
                <button onclick="adminGateway()" class="bg-slate-100 p-2 rounded-xl text-slate-400"><i class="fas fa-lock"></i></button>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto p-4 py-8">
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-10">
            <div class="bg-slate-900 rounded-[2rem] p-8 text-white flex justify-between items-center shadow-xl">
                <div><span class="text-amber-400 font-bold text-xs uppercase">Ø·Ù‚Ø³ Ø¨Ø±ÙƒØ§Ù†</span><h2 id="temp-display" class="text-5xl font-black italic mt-1">--Â°C</h2></div>
                <i class="fas fa-cloud-sun text-6xl opacity-20"></i>
            </div>
            <div class="bg-red-600 rounded-[2rem] p-8 text-white flex flex-col justify-center shadow-xl">
                <div class="flex items-center gap-2 mb-2"><i class="fas fa-prescription-bottle-alt"></i><span class="font-black italic">ØµÙŠØ¯Ù„ÙŠØ§Øª Ø§Ù„Ø­Ø±Ø§Ø³Ø©:</span></div>
                <p id="pharmacy-list" class="font-bold text-lg opacity-90 italic">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„..</p>
            </div>
        </div>

        <div class="flex gap-3 overflow-x-auto pb-6 no-scrollbar" id="tabs">
            <button onclick="setTab('all', event)" class="px-6 py-2 rounded-full bg-blue-600 text-white font-bold shrink-0">Ø§Ù„ÙƒÙ„</button>
            <button onclick="setTab('Ø³ÙŠØ¯ØªÙŠ', event)" class="px-6 py-2 rounded-full bg-white border font-bold shrink-0 hover:bg-pink-50 text-pink-600 border-pink-100">ğŸ’„ Ø³ÙŠØ¯ØªÙŠ</button>
            <button onclick="setTab('Ø¥ØµÙ„Ø§Ø­ ÙˆØµÙŠØ§Ù†Ø©', event)" class="px-6 py-2 rounded-full bg-white border font-bold shrink-0 hover:bg-blue-50">ğŸ”§ Ø®Ø¯Ù…Ø§Øª</button>
            <button onclick="setTab('Ù…Ø·Ø¨Ø® ÙˆØ­Ù„ÙˆÙŠØ§Øª', event)" class="px-6 py-2 rounded-full bg-white border font-bold shrink-0 hover:bg-green-50">ğŸ³ Ù…Ø·Ø¨Ø®</button>
        </div>

        <div id="services-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
            </div>
    </main>

    <div id="reg-modal" class="fixed inset-0 bg-slate-900/80 hidden z-[100] flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white rounded-3xl p-8 max-w-md w-full relative">
            <button onclick="toggleModal('reg-modal', false)" class="absolute top-6 left-6 text-2xl">&times;</button>
            <h3 class="text-2xl font-black mb-6">Ø³Ø¬Ù„ Ø®Ø¯Ù…ØªÙƒ Ø£Ùˆ Ø¥Ù‡Ø¯Ø§Ø¡Ùƒ</h3>
            <div class="space-y-4">
                <input type="text" id="f-name" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" class="w-full p-4 bg-slate-50 rounded-xl border-none font-bold">
                <input type="tel" id="f-phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (Ø£Ùˆ Ø§ÙƒØªØ¨ 'Ø¥Ù‡Ø¯Ø§Ø¡')" class="w-full p-4 bg-slate-50 rounded-xl border-none font-bold">
                <select id="f-cat" class="w-full p-4 bg-slate-50 rounded-xl border-none font-bold">
                    <option value="Ø¥ØµÙ„Ø§Ø­ ÙˆØµÙŠØ§Ù†Ø©">ğŸ”§ Ø®Ø¯Ù…Ø§Øª ÙˆØ¥ØµÙ„Ø§Ø­</option>
                    <option value="Ø³ÙŠØ¯ØªÙŠ">ğŸ’„ Ø¹Ø§Ù„Ù… Ø§Ù„Ù…Ø±Ø£Ø© (Ø³ÙŠØ¯ØªÙŠ)</option>
                    <option value="Ù…Ø·Ø¨Ø® ÙˆØ­Ù„ÙˆÙŠØ§Øª">ğŸ³ Ù…Ø·Ø¨Ø® ÙˆØ­Ù„ÙˆÙŠØ§Øª</option>
                    <option value="Ø¥Ù‡Ø¯Ø§Ø¡">ğŸ Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù‡Ø¯Ø§Ø¡ Ù„Ù„Ø´Ø±ÙŠØ·</option>
                </select>
                <button onclick="saveData()" id="save-btn" class="w-full bg-slate-900 text-white py-4 rounded-xl font-black">Ù†Ø´Ø± Ø§Ù„Ø¢Ù†</button>
            </div>
        </div>
    </div>

    <div id="admin-panel" class="fixed inset-0 bg-white hidden z-[200] overflow-y-auto p-8">
        <div class="max-w-5xl mx-auto">
            <div class="flex justify-between items-center mb-10">
                <h2 class="text-3xl font-black italic">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h2>
                <button onclick="location.reload()" class="bg-red-500 text-white px-6 py-2 rounded-xl">Ø®Ø±ÙˆØ¬</button>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="space-y-4">
                    <input type="text" id="adm-news" placeholder="ØªØ¹Ø¯ÙŠÙ„ Ø´Ø±ÙŠØ· Ø§Ù„Ø£Ø®Ø¨Ø§Ø±" class="w-full p-4 border rounded-xl">
                    <button onclick="updateAdmin('news', 'adm-news')" class="w-full bg-blue-600 text-white py-3 rounded-xl">Ø­ÙØ¸ Ø§Ù„Ø®Ø¨Ø±</button>
                    <input type="text" id="adm-pharm" placeholder="ØªØ¹Ø¯ÙŠÙ„ ØµÙŠØ¯Ù„ÙŠØ§Øª Ø§Ù„Ø­Ø±Ø§Ø³Ø©" class="w-full p-4 border rounded-xl mt-4">
                    <button onclick="updateAdmin('pharmacy', 'adm-pharm')" class="w-full bg-red-600 text-white py-3 rounded-xl">Ø­ÙØ¸ Ø§Ù„ØµÙŠØ¯Ù„ÙŠØ§Øª</button>
                </div>
                <div id="adm-list" class="bg-slate-50 p-6 rounded-2xl max-h-[500px] overflow-y-auto">
                    </div>
            </div>
        </div>
    </div>

    <script>
        const DB_URL = "https://studio-2627154759-2fb87-default-rtdb.firebaseio.com";
        let cache = {};
        let currentTab = 'all';

        async function init() {
            // Ø§Ù„Ø·Ù‚Ø³
            fetch('https://api.open-meteo.com/v1/forecast?latitude=34.92&longitude=-2.32&current_weather=true')
                .then(r => r.json()).then(d => document.getElementById('temp-display').innerText = Math.round(d.current_weather.temperature) + 'Â°C');

            // Ø¬Ù„Ø¨ Firebase
            const res = await fetch(`${DB_URL}/.json`);
            cache = await res.json() || {};
            
            if(cache.admin) {
                document.getElementById('news-ticker').innerText = cache.admin.news || "Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨ÙƒÙ…";
                document.getElementById('pharmacy-list').innerText = cache.admin.pharmacy || "Ù„Ù… ØªØ­Ø¯Ø¯ Ø¨Ø¹Ø¯";
                // Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ù‡Ø¯Ø§Ø¡Ø§Øª ÙˆØ¹Ø±Ø¶Ù‡Ø§ ÙÙŠ Ø´Ø±ÙŠØ· Ø§Ù„Ø¥Ù‡Ø¯Ø§Ø¡Ø§Øª
                const gifts = Object.values(cache.services || {}).filter(s => s.category === 'Ø¥Ù‡Ø¯Ø§Ø¡').map(s => `[${s.name}: ${s.phone}]`).join(' --- ');
                if(gifts) document.getElementById('gift-ticker').innerText = gifts;
            }
            render(cache.services || {});
        }

        function render(data) {
            const grid = document.getElementById('services-grid');
            grid.innerHTML = Object.keys(data).reverse().map(id => {
                const s = data[id];
                if(s.category === 'Ø¥Ù‡Ø¯Ø§Ø¡') return ''; // Ù„Ø§ ØªØ¹Ø±Ø¶ Ø§Ù„Ø¥Ù‡Ø¯Ø§Ø¡Ø§Øª ÙÙŠ Ø§Ù„Ø´Ø¨ÙƒØ©
                let cClass = s.category === 'Ø³ÙŠØ¯ØªÙŠ' ? 'card-woman' : 'card-tech';
                if(s.category === 'Ù…Ø·Ø¨Ø® ÙˆØ­Ù„ÙˆÙŠØ§Øª') cClass = 'card-food';
                
                return `
                    <div class="service-card ${cClass}">
                        <h4 class="text-xl font-black mb-1">${s.name}</h4>
                        <p class="text-[10px] font-black opacity-40 uppercase mb-6">${s.category}</p>
                        <div class="flex gap-2">
                            <a href="tel:${s.phone}" class="flex-1 bg-slate-900 text-white py-2 rounded-xl text-center text-xs font-bold">Ø§ØªØµØ§Ù„</a>
                            <a href="https://wa.me/${s.phone.replace('0', '212')}" class="flex-1 bg-green-500 text-white py-2 rounded-xl text-center text-xs font-bold">ÙˆØ§ØªØ³Ø§Ø¨</a>
                        </div>
                    </div>
                `;
            }).join('');
        }

        window.adminGateway = () => {
            if(prompt("Gmail:") === "imad@gmail.com" && prompt("Pass:") === "2025") {
                toggleModal('admin-panel', true);
                loadAdminList();
            }
        };

        async function loadAdminList() {
            const res = await fetch(`${DB_URL}/services.json`);
            const data = await res.json() || {};
            document.getElementById('adm-list').innerHTML = Object.keys(data).reverse().map(id => `
                <div class="flex justify-between items-center bg-white p-3 mb-2 rounded-xl border">
                    <span class="text-xs font-bold">${data[id].name} (${data[id].category})</span>
                    <button onclick="del('${id}')" class="text-red-500"><i class="fas fa-trash"></i></button>
                </div>
            `).join('');
        }

        window.del = async (id) => { if(confirm("Ø­Ø°ÙØŸ")) { await fetch(`${DB_URL}/services/${id}.json`, {method:'DELETE'}); location.reload(); }};
        
        window.updateAdmin = async (f, i) => {
            const v = document.getElementById(i).value;
            await fetch(`${DB_URL}/admin/${f}.json`, {method:'PUT', body: JSON.stringify(v)});
            location.reload();
        };

        window.saveData = async () => {
            const name = document.getElementById('f-name').value;
            const phone = document.getElementById('f-phone').value;
            const category = document.getElementById('f-cat').value;
            await fetch(`${DB_URL}/services.json`, {method:'POST', body: JSON.stringify({name, phone, category})});
            location.reload();
        };

        window.toggleModal = (id, s) => document.getElementById(id).classList.toggle('hidden', !s);
        init();
    </script>
</body>
</html>
