<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¯Ù„ÙŠÙ„ Ø£ÙƒÙ„ÙŠÙ… ÙˆØ¨Ø±ÙƒØ§Ù† - Ø§ØªØµØ§Ù„ Ø§Ù„Ø®Ø¯Ù…Ø§Øª</title>
    
    <!-- Ø®Ø±Ø§Ø¦Ø· Ø¬ÙˆØ¬Ù„ -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDwxOVCFrQLpiO1N7w50Zeo7PDLLgZI25M&callback=initMap" async defer></script>
    
    <style>
        /* Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { background: #f5f5f5; color: #333; padding: 20px; }
        
        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        .header { background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%); color: white; padding: 25px; text-align: center; border-radius: 15px; margin-bottom: 25px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .header h1 { font-size: 2.2rem; margin-bottom: 10px; }
        
        /* Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª */
        .ads-section { background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%); color: white; padding: 25px; border-radius: 15px; margin-bottom: 25px; text-align: center; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .ads-section h2 { margin-bottom: 15px; font-size: 1.8rem; }
        .ads-section p { margin-bottom: 20px; font-size: 1.1rem; }
        .ads-btn { background: white; color: #e67e22; border: none; padding: 14px 30px; border-radius: 50px; font-size: 18px; font-weight: bold; cursor: pointer; transition: transform 0.3s; display: inline-block; text-decoration: none; }
        .ads-btn:hover { transform: scale(1.05); background: #fff; color: #d35400; }
        
        /* Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª */
        .stats { display: flex; justify-content: space-around; background: white; padding: 20px; border-radius: 12px; margin-bottom: 25px; text-align: center; box-shadow: 0 3px 10px rgba(0,0,0,0.08); }
        .stat-box h3 { font-size: 28px; color: #2c3e50; margin-bottom: 5px; }
        .stat-box p { color: #666; }
        
        /* Ø§Ù„Ø¨Ø­Ø« */
        .search-section { background: white; padding: 25px; border-radius: 12px; margin-bottom: 25px; box-shadow: 0 3px 10px rgba(0,0,0,0.08); }
        .search-box { display: flex; gap: 10px; margin-top: 15px; }
        .search-box input { flex: 1; padding: 14px; border: 2px solid #3498db; border-radius: 10px; font-size: 16px; }
        .search-box button { background: #2ecc71; color: white; border: none; padding: 14px 30px; border-radius: 10px; font-size: 16px; cursor: pointer; font-weight: bold; }
        .search-box button:hover { background: #27ae60; }
        
        /* Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø¬Ø§Ù†Ø¨ÙŠØ© */
        .side-ad { background: white; padding: 20px; border-radius: 10px; margin: 20px 0; border: 2px dashed #3498db; text-align: center; }
        .side-ad h4 { color: #2c3e50; margin-bottom: 10px; }
        .ad-placeholder { background: #f8f9fa; padding: 40px; border-radius: 8px; color: #666; font-size: 1.1rem; }
        
        /* Ø§Ù„Ø®Ø±ÙŠØ·Ø© */
        .map-section { background: white; padding: 25px; border-radius: 12px; margin-bottom: 25px; box-shadow: 0 3px 10px rgba(0,0,0,0.08); }
        #map { height: 300px; width: 100%; border-radius: 10px; margin-top: 15px; border: 2px solid #eee; }
        
        /* Ø§Ù„Ø®Ø¯Ù…Ø§Øª */
        .services-section { background: white; padding: 25px; border-radius: 12px; margin-bottom: 25px; box-shadow: 0 3px 10px rgba(0,0,0,0.08); }
        .services-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; margin: 20px 0; }
        .service-card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 3px 10px rgba(0,0,0,0.1); border-left: 5px solid #3498db; transition: transform 0.3s; position: relative; }
        .service-card:hover { transform: translateY(-5px); box-shadow: 0 5px 15px rgba(0,0,0,0.15); }
        .service-card h3 { color: #2c3e50; margin-bottom: 10px; font-size: 1.3rem; }
        .service-type { display: inline-block; background: #ecf0f1; color: #2c3e50; padding: 5px 12px; border-radius: 20px; font-size: 0.9rem; margin-bottom: 10px; }
        .service-phone { color: #27ae60; font-weight: bold; font-size: 1.1rem; margin: 10px 0; }
        
        /* Ø²Ø± Ø§Ù„Ø§ØªØµØ§Ù„ */
        .call-btn { display: inline-block; background: #2ecc71; color: white; text-decoration: none; padding: 10px 20px; border-radius: 8px; margin-top: 10px; font-weight: bold; text-align: center; transition: background 0.3s; }
        .call-btn:hover { background: #27ae60; }
        
        /* Ø§Ù„Ù†Ø¬ÙˆÙ… */
        .stars { color: #f39c12; font-size: 1.2rem; margin: 10px 0; }
        .stars span { cursor: pointer; }
        .rating-count { color: #666; font-size: 0.9rem; margin-right: 10px; }
        
        /* Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ */
        .form-section { background: white; padding: 25px; border-radius: 12px; margin-bottom: 25px; box-shadow: 0 3px 10px rgba(0,0,0,0.08); }
        .form-group { margin-bottom: 20px; }
        input, select, textarea { width: 100%; padding: 14px; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; transition: border 0.3s; }
        input:focus, select:focus { border-color: #3498db; outline: none; }
        button { background: #3498db; color: white; border: none; padding: 16px; width: 100%; border-radius: 8px; font-size: 17px; cursor: pointer; font-weight: bold; transition: background 0.3s; }
        button:hover { background: #2980b9; }
        .delete-btn { background: #e74c3c; }
        .delete-btn:hover { background: #c0392b; }
        
        /* Ø§Ù„Ø·ÙˆØ§Ø±Ø¦ */
        .emergency-section { background: white; padding: 25px; border-radius: 12px; margin-bottom: 25px; box-shadow: 0 3px 10px rgba(0,0,0,0.08); }
        .emergency-grid { display: flex; justify-content: space-around; margin: 20px 0; }
        .emergency-card { text-align: center; padding: 20px; }
        .emergency-icon { width: 70px; height: 70px; line-height: 70px; background: #e74c3c; color: white; border-radius: 50%; margin: 0 auto 15px; font-weight: bold; font-size: 1.5rem; box-shadow: 0 4px 10px rgba(231, 76, 60, 0.3); }
        
        /* Ø§Ù„ÙÙˆØªØ± */
        footer { text-align: center; margin-top: 40px; color: #666; padding: 20px; background: #f8f9fa; border-radius: 10px; }
        
        /* ØªØµÙ…ÙŠÙ… Ù…ØªØ¬Ø§ÙˆØ¨ */
        @media (max-width: 768px) {
            .stats { flex-direction: column; gap: 15px; }
            .emergency-grid { flex-direction: column; gap: 15px; }
            .services-grid { grid-template-columns: 1fr; }
            .call-btn { display: block; text-align: center; }
            .search-box { flex-direction: column; }
            .search-box button { width: 100%; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
        <header class="header">
            <h1>ğŸ“± Ø¯Ù„ÙŠÙ„ Ø£ÙƒÙ„ÙŠÙ… ÙˆØ¨Ø±ÙƒØ§Ù†</h1>
            <p>Ø®Ø¯Ù…Ø© Ø§Ù„ØªÙˆØµÙŠÙ„ Ù…ØªØ§Ø­Ø© Ø§Ù„Ø¢Ù† ÙÙŠ Ø£ÙƒÙ„ÙŠÙ… ÙˆØ¨Ø±ÙƒØ§Ù† | Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†</p>
        </header>
        
        <!-- Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
        <section class="ads-section">
            <h2>ğŸš€ Ù…Ø³Ø§Ø­Ø© Ø¥Ø¹Ù„Ø§Ù†ÙŠØ© Ù…Ù…ÙŠØ²Ø©</h2>
            <p>Ø¹Ø±Ø¶ Ø¥Ø¹Ù„Ø§Ù†Ùƒ Ù‡Ù†Ø§ Ù„Ø¢Ù„Ø§Ù Ø§Ù„Ø²ÙˆØ§Ø± ÙŠÙˆÙ…ÙŠØ§Ù‹! Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù„Ø¹Ù…Ù„Ø§Ø¦Ùƒ Ø§Ù„Ù…Ø­Ù„ÙŠÙŠÙ†.</p>
            <a href="https://wa.me/212600000000?text=Ø£Ø±ÙŠØ¯%20Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†%20Ø¹Ù„Ù‰%20Ø¯Ù„ÙŠÙ„%20Ø£ÙƒÙ„ÙŠÙ…%20ÙˆØ¨Ø±ÙƒØ§Ù†" class="ads-btn" target="_blank">
                ğŸ“ Ù„Ù„Ø¥Ø¹Ù„Ø§Ù† Ø§ØªØµÙ„ Ø¹Ù„Ù‰: 0600-000000
            </a>
        </section>
        
        <!-- Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
        <section class="stats">
            <div class="stat-box"><h3 id="total-services">0</h3><p>Ø®Ø¯Ù…Ø© Ù…ØªØ§Ø­Ø©</p></div>
            <div class="stat-box"><h3 id="total-cars">0</h3><p>Ø³ÙŠØ§Ø±Ø§Øª Ù„Ù„ÙƒØ±Ø§Ø¡</p></div>
            <div class="stat-box"><h3 id="total-ratings">0</h3><p>ØªÙ‚ÙŠÙŠÙ…</p></div>
        </section>
        
        <!-- Ø§Ù„Ø¨Ø­Ø« -->
        <section class="search-section">
            <h2>ğŸ” Ø¨Ø­Ø« Ø³Ø±ÙŠØ¹ ÙÙŠ Ø§Ù„Ø®Ø¯Ù…Ø§Øª</h2>
            <div class="search-box">
                <input type="text" id="search-input" placeholder="Ø§ÙƒØªØ¨ Ù‡Ù†Ø§ Ù„Ù„Ø¨Ø­Ø« (ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØŒ ØªÙˆØµÙŠÙ„ØŒ ÙƒØ±Ø§Ø¡ Ø³ÙŠØ§Ø±Ø§ØªØŒ Ø·Ø¨ÙŠØ¨...)" onkeypress="if(event.key === 'Enter') searchServices()">
                <button onclick="searchServices()">ğŸ” Ø¨Ø­Ø«</button>
            </div>
            <p style="color: #666; margin-top: 10px; font-size: 0.9rem;">Ø§Ø¨Ø­Ø« Ø¨Ø£ÙŠ ÙƒÙ„Ù…Ø©: Ø§Ø³Ù… Ø§Ù„Ø®Ø¯Ù…Ø©ØŒ Ø§Ù„Ù†ÙˆØ¹ØŒ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©ØŒ Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</p>
        </section>
        
        <!-- Ø¥Ø¹Ù„Ø§Ù† Ø¬Ø§Ù†Ø¨ÙŠ -->
        <div class="side-ad">
            <h4>ğŸ“¢ Ù…Ø³Ø§Ø­Ø© Ø¥Ø¹Ù„Ø§Ù†ÙŠØ©</h4>
            <div class="ad-placeholder">
                <p>Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ù…ØªØ§Ø­Ø© Ù„Ù„Ø¥Ø¹Ù„Ø§Ù†</p>
                <p style="font-size: 0.9rem; margin-top: 10px;">ğŸ“ Ù…ÙˆÙ‚Ø¹ Ù…Ù…ÙŠØ² - Ø¢Ù„Ø§Ù Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø§Øª ÙŠÙˆÙ…ÙŠØ§Ù‹</p>
                <p style="font-size: 0.9rem;">ğŸ“ Ù„Ù„Ø¥Ø¹Ù„Ø§Ù†: 0600-000000</p>
            </div>
        </div>
        
        <!-- Ø§Ù„Ø®Ø±ÙŠØ·Ø© -->
        <section class="map-section">
            <h2>ğŸ—ºï¸ Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø®Ø¯Ù…Ø§Øª ÙÙŠ Ø£ÙƒÙ„ÙŠÙ… ÙˆØ¨Ø±ÙƒØ§Ù†</h2>
            <p>ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ø®Ø¯Ù…Ø§Øª ÙÙŠ Ù…Ù†Ø·Ù‚ØªÙƒ</p>
            <div id="map"></div>
        </section>
        
        <!-- Ø§Ù„Ø®Ø¯Ù…Ø§Øª -->
        <section class="services-section">
            <h2>â­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©</h2>
            <div id="search-results-info" style="color: #666; margin-bottom: 15px;"></div>
            <div class="services-grid" id="services-container">
                <!-- Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
            </div>
        </section>
        
        <!-- Ø¥Ø¹Ù„Ø§Ù† Ø¬Ø§Ù†Ø¨ÙŠ Ø¢Ø®Ø± -->
        <div class="side-ad">
            <h4>ğŸ’¼ ØªØ±ÙŠØ¯ Ø²ÙŠØ§Ø¯Ø© Ù…Ø¨ÙŠØ¹Ø§ØªÙƒØŸ</h4>
            <div class="ad-placeholder">
                <p>Ø¥Ø¹Ù„Ø§Ù†Ùƒ Ù‡Ù†Ø§ ÙŠØµÙ„ Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙÙŠÙ† Ù…Ø¨Ø§Ø´Ø±Ø©</p>
                <p style="font-size: 0.9rem; margin-top: 10px;">âœ… 150+ Ø²Ø§Ø¦Ø± ÙŠÙˆÙ…ÙŠØ§Ù‹</p>
                <p style="font-size: 0.9rem;">âœ… ÙˆØµÙˆÙ„ Ù…Ø­Ù„ÙŠ Ù…Ø¨Ø§Ø´Ø±</p>
            </div>
        </div>
        
        <!-- Ø¥Ø¶Ø§ÙØ© Ø®Ø¯Ù…Ø© -->
        <section class="form-section">
            <h2>â• Ø¥Ø¶Ø§ÙØ© Ø®Ø¯Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©</h2>
            <form id="add-service-form">
                <div class="form-group"><input type="text" id="service-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ø®Ø¯Ù…Ø© (Ù…Ø«Ø§Ù„: ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ Ù…Ù†Ø§Ø²Ù„)" required></div>
                <div class="form-group">
                    <select id="service-type" required>
                        <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©</option>
                        <option value="ØªÙˆØµÙŠÙ„">ØªÙˆØµÙŠÙ„</option>
                        <option value="ØµÙŠØ§Ù†Ø©">ØµÙŠØ§Ù†Ø©</option>
                        <option value="Ø·Ø¨ÙŠ">Ø·Ø¨ÙŠ</option>
                        <option value="ÙƒØ±Ø§Ø¡ Ø³ÙŠØ§Ø±Ø§Øª">ÙƒØ±Ø§Ø¡ Ø³ÙŠØ§Ø±Ø§Øª</option>
                        <option value="Ø£Ø®Ø±Ù‰">Ø£Ø®Ø±Ù‰</option>
                    </select>
                </div>
                <div class="form-group"><input type="tel" id="service-phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (Ù…Ø«Ø§Ù„: 0620-123456)" required></div>
                <div class="form-group">
                    <select id="service-location" required>
                        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</option>
                        <option value="Ø£ÙƒÙ„ÙŠÙ…">Ø£ÙƒÙ„ÙŠÙ…</option>
                        <option value="Ø¨Ø±ÙƒØ§Ù†">Ø¨Ø±ÙƒØ§Ù†</option>
                    </select>
                </div>
                <div class="form-group"><textarea id="service-description" placeholder="ÙˆØµÙ Ø§Ù„Ø®Ø¯Ù…Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" rows="3"></textarea></div>
                <button type="submit" class="submit-btn">â• Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø®Ø¯Ù…Ø©</button>
            </form>
        </section>
        
        <!-- Ø­Ø°Ù Ø®Ø¯Ù…Ø© -->
        <section class="form-section">
            <h2>ğŸ—‘ï¸ Ø­Ø°Ù Ø®Ø¯Ù…Ø©</h2>
            <form id="delete-service-form">
                <div class="form-group"><input type="tel" id="delete-phone" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ø®Ø¯Ù…Ø© Ù„Ù„Ø­Ø°Ù" required></div>
                <button type="submit" class="delete-btn">ğŸ—‘ï¸ Ø­Ø°Ù Ø§Ù„Ø®Ø¯Ù…Ø©</button>
            </form>
        </section>
        
        <!-- Ø§Ù„Ø·ÙˆØ§Ø±Ø¦ -->
        <section class="emergency-section">
            <h2>ğŸš¨ Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø·ÙˆØ§Ø±Ø¦</h2>
            <div class="emergency-grid">
                <div class="emergency-card"><div class="emergency-icon">15</div><h3>Ø§Ù„Ø·ÙˆØ§Ø±Ø¦ Ø§Ù„ØµØ­ÙŠØ©</h3></div>
                <div class="emergency-card"><div class="emergency-icon">18</div><h3>Ø§Ù„Ù…Ø·Ø§ÙØ¦</h3></div>
                <div class="emergency-card"><div class="emergency-icon">19</div><h3>Ø§Ù„Ø´Ø±Ø·Ø©</h3></div>
            </div>
        </section>
        
        <!-- Ø§Ù„ÙÙˆØªØ± -->
        <footer>
            <p>Â© 2025 Ø¯Ù„ÙŠÙ„ Ø£ÙƒÙ„ÙŠÙ… ÙˆØ¨Ø±ÙƒØ§Ù† - Ø§ØªØµØ§Ù„ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©</p>
            <p>ğŸ“ Ù„Ù„Ø¥Ø¹Ù„Ø§Ù† Ø£Ùˆ Ø§Ù„Ø¯Ø¹Ù…: 0600-000000 | âœ‰ï¸ info@example.com</p>
            <p style="margin-top: 10px; font-size: 0.9rem; color: #888;">Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙŠØ³Ø§Ø¹Ø¯ ÙÙŠ Ø±Ø¨Ø· Ø§Ù„Ù…Ø¬ØªÙ…Ø¹ Ø§Ù„Ù…Ø­Ù„ÙŠ Ø¨Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</p>
        </footer>
    </div>
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    
    <script>
        // ğŸ”¥ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyDwxOVCFrQLpiO1N7w50Zeo7PDLLgZI25M",
            authDomain: "studio-2627154759-2fb87.firebaseapp.com",
            databaseURL: "https://studio-2627154759-2fb87-default-rtdb.firebaseio.com",
            projectId: "studio-2627154759-2fb87",
            storageBucket: "studio-2627154759-2fb87.firebasestorage.app",
            messagingSenderId: "450927110806",
            appId: "1:450927110806:web:adcd8d20ea0aaa4a4830b7"
        };
        
        // ØªÙ‡ÙŠØ¦Ø© Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        
        // Ù…ØªØºÙŠØ±Ø§Øª Ø¹Ø§Ù…Ø©
        let allServices = [];
        let currentServices = [];
        
        // Ø¹Ù†Ø§ØµØ± Ø§Ù„ØµÙØ­Ø©
        const servicesContainer = document.getElementById('services-container');
        const addServiceForm = document.getElementById('add-service-form');
        const deleteServiceForm = document.getElementById('delete-service-form');
        const totalServicesElement = document.getElementById('total-services');
        const totalCarsElement = document.getElementById('total-cars');
        const totalRatingsElement = document.getElementById('total-ratings');
        const searchResultsInfo = document.getElementById('search-results-info');
        
        // Ø§Ù„Ø®Ø±ÙŠØ·Ø©
        let map;
        let markers = [];
        
        function initMap() {
            map = new google.maps.Map(document.getElementById('map'), {
                center: { lat: 34.88, lng: -2.32 },
                zoom: 12,
                mapTypeControl: true,
                streetViewControl: false
            });
        }
        
        // Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', function() {
            loadServices();
            loadRatingsCount();
            
            // Ø¥Ø¶Ø§ÙØ© Ø®Ø¯Ù…Ø©
            addServiceForm.addEventListener('submit', function(e) {
                e.preventDefault();
                addNewService();
            });
            
            // Ø­Ø°Ù Ø®Ø¯Ù…Ø©
            deleteServiceForm.addEventListener('submit', function(e) {
                e.preventDefault();
                deleteServiceByPhone();
            });
            
            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Enter
            document.getElementById('search-input').addEventListener('keyup', function(e) {
                if (e.key === 'Enter') {
                    searchServices();
                }
            });
        });
        
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø§Øª
        function loadServices() {
            servicesContainer.innerHTML = '<p style="text-align:center; padding: 20px;">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø§Øª...</p>';
            searchResultsInfo.textContent = '';
            
            database.ref('services').on('value', function(snapshot) {
                allServices = [];
                currentServices = [];
                
                servicesContainer.innerHTML = '';
                markers.forEach(marker => marker.setMap(null));
                markers = [];
                
                let servicesCount = 0;
                let carsCount = 0;
                
                if (snapshot.exists()) {
                    snapshot.forEach(function(child) {
                        const service = child.val();
                        service.id = child.key;
                        allServices.push(service);
                        currentServices.push(service);
                        
                        // Ø¹Ø±Ø¶ Ø§Ù„Ø®Ø¯Ù…Ø©
                        displayService(service);
                        
                        // Ø¥Ø¶Ø§ÙØ© Ø¹Ù„Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©
                        if (map) {
                            addToMap(service);
                        }
                        
                        // Ø¹Ø¯ Ø§Ù„Ø®Ø¯Ù…Ø§Øª
                        servicesCount++;
                        if (service.type === 'ÙƒØ±Ø§Ø¡ Ø³ÙŠØ§Ø±Ø§Øª') carsCount++;
                    });
                    
                    searchResultsInfo.textContent = `Ø¹Ø±Ø¶ ${allServices.length} Ø®Ø¯Ù…Ø©`;
                } else {
                    servicesContainer.innerHTML = '<p style="text-align:center; padding: 20px; color: #666;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø®Ø¯Ù…Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹. ÙƒÙ† Ø£ÙˆÙ„ Ù…Ù† ÙŠØ¶ÙŠÙ Ø®Ø¯Ù…Ø©! â•</p>';
                    searchResultsInfo.textContent = '';
                }
                
                totalServicesElement.textContent = servicesCount;
                totalCarsElement.textContent = carsCount;
            });
        }
        
        // Ø§Ù„Ø¨Ø­Ø« - Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù…ØµØ­Ø­
        function searchServices() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase().trim();
            
            if (!searchTerm) {
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¨Ø­Ø« ÙØ§Ø±ØºØ§Ù‹ØŒ Ø¹Ø±Ø¶ ÙƒÙ„ Ø§Ù„Ø®Ø¯Ù…Ø§Øª
                currentServices = [...allServices];
                searchResultsInfo.textContent = `Ø¹Ø±Ø¶ ${allServices.length} Ø®Ø¯Ù…Ø©`;
                displayFilteredServices();
                return;
            }
            
            // ØªØµÙÙŠØ© Ø§Ù„Ø®Ø¯Ù…Ø§Øª
            currentServices = allServices.filter(service => {
                return (
                    service.name.toLowerCase().includes(searchTerm) ||
                    service.type.toLowerCase().includes(searchTerm) ||
                    service.location.toLowerCase().includes(searchTerm) ||
                    service.phone.includes(searchTerm) ||
                    (service.description && service.description.toLowerCase().includes(searchTerm))
                );
            });
            
            // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¨Ø­Ø«
            if (currentServices.length === 0) {
                searchResultsInfo.innerHTML = `<span style="color: #e74c3c;">âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø®Ø¯Ù…Ø§Øª ØªØ·Ø§Ø¨Ù‚ "${searchTerm}"</span>`;
            } else {
                searchResultsInfo.textContent = `Ø¹Ø±Ø¶ ${currentServices.length} Ù…Ù† ${allServices.length} Ø®Ø¯Ù…Ø© ØªØ·Ø§Ø¨Ù‚ "${searchTerm}"`;
            }
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…ÙÙ„ØªØ±Ø©
            displayFilteredServices();
        }
        
        // Ø¹Ø±Ø¶ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…ÙÙ„ØªØ±Ø©
        function displayFilteredServices() {
            servicesContainer.innerHTML = '';
            
            if (currentServices.length === 0) {
                servicesContainer.innerHTML = `
                    <div style="text-align:center; padding: 40px; color: #666; grid-column: 1 / -1;">
                        <h3>âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø®Ø¯Ù…Ø§Øª</h3>
                        <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø®Ø¯Ù…Ø§Øª ØªØ·Ø§Ø¨Ù‚ "${document.getElementById('search-input').value}"</p>
                        <button onclick="clearSearch()" style="background: #3498db; color: white; border: none; padding: 10px 20px; border-radius: 5px; margin-top: 10px; cursor: pointer;">
                            Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®Ø¯Ù…Ø§Øª
                        </button>
                    </div>
                `;
                return;
            }
            
            currentServices.forEach(service => {
                displayService(service);
            });
        }
        
        function clearSearch() {
            document.getElementById('search-input').value = '';
            currentServices = [...allServices];
            searchResultsInfo.textContent = `Ø¹Ø±Ø¶ ${allServices.length} Ø®Ø¯Ù…Ø©`;
            displayFilteredServices();
        }
        
        // Ø¹Ø±Ø¶ Ø®Ø¯Ù…Ø© Ù…Ø¹ Ø²Ø± Ø§Ù„Ø§ØªØµØ§Ù„
        function displayService(service) {
            const serviceCard = document.createElement('div');
            serviceCard.className = 'service-card';
            serviceCard.id = 'service-' + service.id;
            
            // Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù†ÙˆØ¹
            const typeIcons = {
                'ØªÙˆØµÙŠÙ„': 'ğŸšš',
                'ØµÙŠØ§Ù†Ø©': 'ğŸ”§',
                'Ø·Ø¨ÙŠ': 'ğŸ¥',
                'ÙƒØ±Ø§Ø¡ Ø³ÙŠØ§Ø±Ø§Øª': 'ğŸš—',
                'Ø£Ø®Ø±Ù‰': 'â­'
            };
            
            // ØªÙ†Ø¸ÙŠÙ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù„Ù„Ø§ØªØµØ§Ù„
            const cleanPhone = service.phone.replace(/-/g, '');
            
            serviceCard.innerHTML = `
                <div class="service-type">${typeIcons[service.type] || 'â­'} ${service.type}</div>
                <h3>${service.name}</h3>
                <p><strong>ğŸ“ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©:</strong> ${service.location}</p>
                <p class="service-phone">ğŸ“ ${service.phone}</p>
                
                <!-- Ø²Ø± Ø§Ù„Ø§ØªØµØ§Ù„ -->
                <a href="tel:${cleanPhone}" class="call-btn">
                    ğŸ“ Ø§ØªØµÙ„ Ø§Ù„Ø¢Ù†
                </a>
                
                ${service.description ? `<p><strong>ğŸ“ Ø§Ù„ÙˆØµÙ:</strong> ${service.description}</p>` : ''}
                
                <!-- Ø§Ù„Ù†Ø¬ÙˆÙ… -->
                <div class="stars" id="stars-${service.id}">
                    <span class="rating-count" id="rating-count-${service.id}">0 ØªÙ‚ÙŠÙŠÙ…</span>
                    ${[1,2,3,4,5].map(star => `
                        <span onclick="rateService('${service.id}', ${star})">${getStarIcon(service.id, star)}</span>
                    `).join('')}
                    <span id="average-${service.id}" style="color: #666; margin-right: 10px;">(0.0)</span>
                </div>
                
                <p><small>â° ${service.date || 'ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø­Ø¯ÙŠØ«Ø§Ù‹'}</small></p>
            `;
            
            servicesContainer.appendChild(serviceCard);
            loadServiceRatings(service.id);
        }
        
        // Ø¥Ø¶Ø§ÙØ© Ø¹Ù„Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©
        function addToMap(service) {
            if (!map) return;
            
            const locations = {
                'Ø£ÙƒÙ„ÙŠÙ…': { lat: 34.88 + (Math.random() * 0.02 - 0.01), lng: -2.32 + (Math.random() * 0.02 - 0.01) },
                'Ø¨Ø±ÙƒØ§Ù†': { lat: 34.86 + (Math.random() * 0.02 - 0.01), lng: -2.34 + (Math.random() * 0.02 - 0.01) }
            };
            
            const position = locations[service.location] || locations['Ø£ÙƒÙ„ÙŠÙ…'];
            
            const marker = new google.maps.Marker({
                position: position,
                map: map,
                title: service.name,
                label: service.type === 'ÙƒØ±Ø§Ø¡ Ø³ÙŠØ§Ø±Ø§Øª' ? 'ğŸš—' : 'ğŸ“'
            });
            
            const infoWindow = new google.maps.InfoWindow({
                content: `
                    <div style="text-align: right; direction: rtl;">
                        <strong>${service.name}</strong><br>
                        ${service.type}<br>
                        ğŸ“ ${service.phone}<br>
                        <a href="tel:${service.phone.replace(/-/g, '')}" style="color: #2ecc71; font-weight: bold;">Ø§ØªØµÙ„ Ø§Ù„Ø¢Ù†</a>
                    </div>
                `
            });
            
            marker.addListener('click', () => {
                infoWindow.open(map, marker);
            });
            
            markers.push(marker);
        }
        
        // Ø¥Ø¶Ø§ÙØ© Ø®Ø¯Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©
        function addNewService() {
            const name = document.getElementById('service-name').value.trim();
            const type = document.getElementById('service-type').value;
            const phone = document.getElementById('service-phone').value.trim();
            const location = document.getElementById('service-location').value;
            const description = document.getElementById('service-description').value.trim();
            
            if (!name || !type || !phone || !location) {
                alert('âš ï¸ ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ù„Ø²Ø§Ù…ÙŠØ©');
                return;
            }
            
            const btn = addServiceForm.querySelector('button');
            const originalText = btn.textContent;
            btn.textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø¶Ø§ÙØ©...';
            btn.disabled = true;
            
            const newService = {
                name: name,
                type: type,
                phone: phone,
                location: location,
                description: description || '',
                date: new Date().toLocaleString('ar-EG'),
                createdAt: Date.now()
            };
            
            database.ref('services').push(newService)
                .then(() => {
                    alert('âœ… ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø®Ø¯Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­!');
                    addServiceForm.reset();
                    document.getElementById('search-input').value = '';
                    loadServices();
                })
                .catch(error => {
                    alert('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£: ' + error.message);
                })
                .finally(() => {
                    btn.textContent = originalText;
                    btn.disabled = false;
                });
        }
        
        // Ø­Ø°Ù Ø®Ø¯Ù…Ø©
        function deleteServiceByPhone() {
            const phone = document.getElementById('delete-phone').value.trim();
            
            if (!phone) {
                alert('âš ï¸ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ');
                return;
            }
            
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø¯Ù…Ø©ØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡.')) {
                return;
            }
            
            const btn = deleteServiceForm.querySelector('button');
            const originalText = btn.textContent;
            btn.textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­Ø°Ù...';
            btn.disabled = true;
            
            database.ref('services').orderByChild('phone').equalTo(phone).once('value')
                .then(snapshot => {
                    if (!snapshot.exists()) {
                        alert('âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø®Ø¯Ù…Ø© Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù…');
                        return;
                    }
                    
                    const promises = [];
                    snapshot.forEach(child => {
                        promises.push(child.ref.remove());
                    });
                    
                    return Promise.all(promises);
                })
                .then(() => {
                    alert('âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ø®Ø¯Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­');
                    deleteServiceForm.reset();
                    document.getElementById('search-input').value = '';
                    loadServices();
                })
                .catch(error => {
                    alert('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£: ' + error.message);
                })
                .finally(() => {
                    btn.textContent = originalText;
                    btn.disabled = false;
                });
        }
        
        // Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª
        function getStarIcon(serviceId, star) {
            const rating = localStorage.getItem(`rating-${serviceId}`) || 0;
            return star <= rating ? 'â˜…' : 'â˜†';
        }
        
        function rateService(serviceId, stars) {
            localStorage.setItem(`rating-${serviceId}`, stars);
            
            const ratingRef = database.ref(`ratings/${serviceId}`).push();
            ratingRef.set({
                stars: stars,
                timestamp: Date.now()
            });
            
            loadServiceRatings(serviceId);
            loadRatingsCount();
        }
        
        function loadServiceRatings(serviceId) {
            database.ref(`ratings/${serviceId}`).once('value')
                .then(snapshot => {
                    let total = 0;
                    let count = 0;
                    
                    if (snapshot.exists()) {
                        snapshot.forEach(child => {
                            const rating = child.val();
                            total += rating.stars;
                            count++;
                        });
                    }
                    
                    const avg = count > 0 ? (total / count).toFixed(1) : '0.0';
                    
                    const ratingCountElement = document.getElementById(`rating-count-${serviceId}`);
                    const averageElement = document.getElementById(`average-${serviceId}`);
                    const starsElement = document.getElementById(`stars-${serviceId}`);
                    
                    if (ratingCountElement) ratingCountElement.textContent = `${count} ØªÙ‚ÙŠÙŠÙ…${count !== 1 ? 'Ø§Øª' : ''}`;
                    if (averageElement) averageElement.textContent = `(${avg})`;
                    
                    if (starsElement) {
                        const starSpans = starsElement.querySelectorAll('span');
                        starSpans.forEach((span, index) => {
                            if (index > 0) {
                                const starNum = index;
                                span.textContent = starNum <= avg ? 'â˜…' : 'â˜†';
                            }
                        });
                    }
                });
        }
        
        function loadRatingsCount() {
            database.ref('ratings').once('value')
                .then(snapshot => {
                    let totalRatings = 0;
                    if (snapshot.exists()) {
                        snapshot.forEach(service => {
                            totalRatings += service.numChildren() || 0;
                        });
                    }
                    totalRatingsElement.textContent = totalRatings;
                });
        }
        
        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ API
        window.initMap = initMap;
    </script>
</body>
    </html>
